# 设为桌面壁纸 (Set As Background)

本插件适用于 **Eagle**，允许用户右键单击图片，将其设为系统桌面壁纸。插件提供以下功能：

- [x] **图片预览**：在插件窗口中显示选中图片的预览。
- [ ] **多显示器支持**：可识别系统的多个显示器，并允许用户单独选择需要设置壁纸的显示器。
- [x] **填充模式选择**：支持多种壁纸填充方式，包括填充、适应、拉伸、居中、平铺、跨区。
- [x] **自动监听选中图片**：当用户在 Eagle 内切换选中的图片时，插件会自动更新预览。
- [x] **窗口优化**：插件窗口大小固定，并置顶，防止误操作调整窗口大小。

---

## 安装方法

**1. 直接使用插件文件夹**

**直接将本文件夹导入**: 依次选择: Eagle菜单--> 插件--> 开发者选项--> 导入本地项目,
将整个项目文件夹导入到 Eagle 中即可。

**2. 使用 npm 安装依赖（可选）**

本插件使用 [`wallpaper`](https://www.npmjs.com/package/wallpaper) 进行壁纸设置。如果你希望手动安装依赖，可以在插件目录下执行：

```sh
npm install
```

> **⚠ 注意**：请确保 `wallpaper` 版本为 `5.0.1`，其他版本可能不兼容。

---

## 使用方法

1. **在 Eagle 内右键图片**，选择 **“设为桌面壁纸”** 启动插件。
2. **选择目标显示器**：
   - 插件窗口会显示当前系统的多个显示器排列方式。
   - 点击某个显示器即可选中，并将当前 Eagle 选中的图片应用到该显示器上。
3. **选择填充方式**：
   - 可选择 **填充（Fill）、适应（Fit）、拉伸（Stretch）、居中（Center）、平铺（Tile）、跨区（Span）**。
   - 每个显示器的填充方式可单独调整，不会影响其他显示器。
4. **设置壁纸**：
   - 点击 **“确定”** 按钮，将壁纸设置到系统。
   - 如果不想设置，可点击 **“取消”** 关闭窗口。

---

## 关于多显示器单独设置壁纸的说明

目前插件的核心功能已实现，但 **多显示器单独设置壁纸** 仍存在一些局限性：

1. **Windows 默认不支持为不同显示器设置不同壁纸**：
   - Windows 提供的 **DesktopWallpaper COM 接口** 可以分别为每个显示器设置不同壁纸，但部分系统可能无法正确使用该功能。
   - 本插件原本设计了 `setWallpaper.ps1` PowerShell 脚本，以便单独设置每个显示器的壁纸。但该脚本在部分 Windows 版本上可能因 **COM 组件缺失** 而无法执行。

2. **目前方案的限制**：
   - 目前使用 [`wallpaper`](https://www.npmjs.com/package/wallpaper) 库，该库 **无法直接控制不同显示器的壁纸**，只能统一设置。
   - 如果用户希望为每个显示器单独设置不同壁纸，可能需要手动修改 `setWallpaper.ps1` 并在 `plugin.js` 中调用 PowerShell 脚本。

3. **未来计划**：
   - 未来版本可能会考虑 **自动检测系统是否支持 DesktopWallpaper COM**，如果支持则启用 **每个显示器独立壁纸**，否则只能统一设置所有显示器相同壁纸的模式。

---

## 其他注意事项

- **插件窗口大小固定**，不可调整，避免误操作导致 UI 变形。
- **插件支持窗口置顶**，防止被其他窗口遮挡。
- **Eagle 选中的图片会自动同步**，无需手动刷新窗口。

如果遇到任何问题，请在 GitHub 反馈，或手动检查 `setWallpaper.ps1` 是否能正确执行。