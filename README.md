# 设为桌面壁纸

这是一个 Eagle 的插件，允许用户右键单击图片，将其设为系统桌面壁纸。插件提供以下功能：

- **图片预览**：在插件窗口中显示选中图片的预览。
- **壁纸设置**：点击确认后调用 [`wallpaper`](package.json) 模块将选中图片设置为系统壁纸。
- **多显示器预览**：在界面上显示多个显示器的分布，用户可以单独选中某些显示器来预览壁纸填充效果。

## 使用方法

1. **安装依赖**  
   请确保已安装 [`wallpaper@5.0.1`](package.json) 依赖，可以通过以下命令进行安装：
   ```sh
   npm install
   ```
   在 Eagle 中使用插件
在 Eagle 中右键单击选中的图片启动此插件。插件会自动打开预览窗口，展示当前图片及所有显示器的预览效果。

2. **设置壁纸**
   在预览窗口中，点击相应的显示器框选中需要设置壁纸的显示器；
   选择合适的填充模式（例如：填充、拉伸、居中、平铺）；
   点击“确定”按钮，调用 wallpaper.set() 设置系统壁纸；
   若取消操作，则点击“取消”按钮关闭窗口。


## 关于多显示器单独设置壁纸功能
目前插件的主要功能已经实现，但存在一个已知问题：
插件无法为多个显示器单独设置不同的壁纸。目录中的 setWallpaper.ps1 文件原本是为了实现对单个显示器单独设置壁纸的操作，该脚本通过创建 IDesktopWallpaper COM 对象来获取显示器 ID 并设置壁纸。
但是目前在部分系统上使用时会遇到 COM 组件缺失的问题，该问题短期内可能无法解决。
因此，目前只能实现统一设置所有显示器壁纸的功能，如有特殊需求，请关注后续更新或考虑其他方案。
